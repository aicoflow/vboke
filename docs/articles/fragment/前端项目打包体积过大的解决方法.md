---
date: 2025-10-31 18:41:50
title: å‰ç«¯é¡¹ç›®æ‰“åŒ…ä½“ç§¯è¿‡å¤§çš„è§£å†³æ–¹æ³•
description: â€œæ‰“åŒ…ä½“ç§¯è¿‡å¤§â€æ˜¯å‰ç«¯å¼€å‘ä¸­éå¸¸å¸¸è§ã€ä¸”å½±å“æ€§èƒ½æœ€æ˜æ˜¾çš„é—®é¢˜ä¹‹ä¸€ã€‚
 æˆ‘ä»¬å¯ä»¥ä» ä»£ç å±‚é¢ã€ä¾èµ–å±‚é¢ã€æ„å»ºå±‚é¢ã€èµ„æºå±‚é¢ å››ä¸ªè§’åº¦æ¥ä¼˜åŒ–ã€‚
categories:
  - çŸ¥è¯†æŠ€èƒ½
tags:
  - JavaScript
sidebar: false

---

# å‰ç«¯é¡¹ç›®æ‰“åŒ…ä½“ç§¯è¿‡å¤§çš„è§£å†³æ–¹æ³•

â€œæ‰“åŒ…ä½“ç§¯è¿‡å¤§â€æ˜¯å‰ç«¯å¼€å‘ä¸­**éå¸¸å¸¸è§ã€ä¸”å½±å“æ€§èƒ½æœ€æ˜æ˜¾çš„é—®é¢˜ä¹‹ä¸€**ã€‚
 æˆ‘ä»¬å¯ä»¥ä» **ä»£ç å±‚é¢ã€ä¾èµ–å±‚é¢ã€æ„å»ºå±‚é¢ã€èµ„æºå±‚é¢** å››ä¸ªè§’åº¦æ¥ä¼˜åŒ–ã€‚

## ğŸš€ ä¸€ã€ä»£ç å±‚é¢ä¼˜åŒ–

### 1ï¸âƒ£ æŒ‰éœ€åŠ è½½ï¼ˆLazy Loading / Code Splittingï¼‰

- **æ€è·¯**ï¼šåªåŠ è½½å½“å‰é¡µé¢éœ€è¦çš„ä»£ç ã€‚

- **å®ç°æ–¹å¼**ï¼š

  - React ç¤ºä¾‹ï¼š

    ```
    import React, { lazy, Suspense } from "react";
    
    const About = lazy(() => import("./pages/About"));
    const Home = lazy(() => import("./pages/Home"));
    
    function App() {
      return (
        <Suspense fallback={<div>Loading...</div>}>
          <Router>
            <Route path="/about" element={<About />} />
            <Route path="/" element={<Home />} />
          </Router>
        </Suspense>
      );
    }
    ```

  - Webpack è‡ªåŠ¨ä»£ç åˆ†å‰² (`import()` åŠ¨æ€å¯¼å…¥)ã€‚

**æ•ˆæœï¼š**
 ğŸ‘‰ åˆå§‹åŒ…ä½“ç§¯æ˜¾è‘—é™ä½ï¼Œåªåœ¨éœ€è¦æ—¶åŠ è½½é¢å¤–æ¨¡å—ã€‚

------

### 2ï¸âƒ£ Tree Shakingï¼ˆæ‘‡æ ‘ä¼˜åŒ–ï¼‰

- **åŸç†**ï¼šç§»é™¤æœªè¢«ä½¿ç”¨çš„æ¨¡å—å¯¼å‡ºï¼ˆä»…æ”¯æŒ ES Modulesï¼‰ã€‚

- **é…ç½®æ–¹å¼ï¼ˆWebpack / Vite è‡ªåŠ¨æ”¯æŒï¼‰**ï¼š

  ```
  // package.json
  {
    "sideEffects": false
  }
  ```

- ç¡®ä¿ä½¿ç”¨ ES6 æ¨¡å—è¯­æ³•ï¼ˆ`import/export`ï¼‰ï¼Œä¸è¦ç”¨ `require`ã€‚

------

### 3ï¸âƒ£ å‡å°‘ polyfill ä¸ç¬¬ä¸‰æ–¹åŒ…å¼•å…¥

- ä»…åœ¨éœ€è¦æ—¶å¼•å…¥ polyfillï¼ˆå¦‚ core-js / babel-polyfillï¼‰ã€‚
- ç”¨ **babel-preset-env** é…åˆ `useBuiltIns: "usage"`ï¼Œè‡ªåŠ¨æŒ‰éœ€æ³¨å…¥ polyfillã€‚
- å¯¹äºå¤§å‹åº“ï¼ˆå¦‚ lodashã€momentï¼‰ï¼Œæ”¹ç”¨è½»é‡æ›¿ä»£ï¼š
  - lodash â†’ lodash-esï¼ˆå¯ Tree Shakingï¼‰
  - moment â†’ dayjs
  - axios â†’ fetchï¼ˆå†…ç½®å³å¯ï¼‰

------

## ğŸ“¦ äºŒã€ä¾èµ–å±‚é¢ä¼˜åŒ–

### 1ï¸âƒ£ åˆ†ææ‰“åŒ…ä½“ç§¯

ä½¿ç”¨å¯è§†åŒ–å·¥å…·æŸ¥çœ‹å“ªäº›æ¨¡å—æœ€å ä½“ç§¯ï¼š

- **Webpack**ï¼š

  ```
  npm run build -- --stats-json
  npx webpack-bundle-analyzer dist/stats.json
  ```

- **Vite**ï¼š

  ```
  npm run build -- --report
  ```

è¿™äº›å·¥å…·èƒ½ç›´è§‚å±•ç¤ºæ¯ä¸ªä¾èµ–çš„å¤§å°ã€‚

### 2ï¸âƒ£ æ‹†åˆ†ç¬¬ä¸‰æ–¹åº“ï¼ˆVendor Splittingï¼‰

è®©ä¸»ä¸šåŠ¡ä»£ç ä¸ç¬¬ä¸‰æ–¹åº“åˆ†å¼€ç¼“å­˜ï¼š

```
// Webpack config
optimization: {
  splitChunks: {
    chunks: "all",
    cacheGroups: {
      vendors: {
        test: /[\\/]node_modules[\\/]/,
        name: "vendors",
        chunks: "all",
      },
    },
  },
}
```

------

## âš™ï¸ ä¸‰ã€æ„å»ºå±‚é¢ä¼˜åŒ–

### 1ï¸âƒ£ å‹ç¼©ä¸æ··æ·†

- å¯ç”¨ **TerserPlugin / esbuild / swc** å‹ç¼© JavaScriptã€‚
- ä½¿ç”¨ **cssnano / postcss** å‹ç¼© CSSã€‚
- Viteã€Next.js é»˜è®¤å·²å¯ç”¨ç”Ÿäº§å‹ç¼©ã€‚

### 2ï¸âƒ£ ä½¿ç”¨ gzip / brotli å‹ç¼©

- æ„å»ºæ—¶ç”Ÿæˆå‹ç¼©ç‰ˆæœ¬ï¼š

  ```
  npm install compression-webpack-plugin
  ```

- æˆ–åœ¨ Nginx / CDN å±‚å¼€å¯ï¼š

  ```
  gzip on;
  gzip_types text/javascript text/css;
  ```

### 3ï¸âƒ£ å›¾ç‰‡ä¸å­—ä½“ä¼˜åŒ–

- å›¾ç‰‡æ ¼å¼ï¼šä½¿ç”¨ WebPã€AVIFã€‚
- å­—ä½“ï¼šä½¿ç”¨å­é›†åŒ–ï¼ˆsubsetï¼‰æˆ– CDNã€‚
- å‹ç¼©å·¥å…·ï¼š`image-webpack-loader`ã€`svgo`ã€‚

------

## ğŸ§© å››ã€èµ„æºå±‚é¢ä¼˜åŒ–

### 1ï¸âƒ£ é™æ€èµ„æºåˆ†ç¦»ä¸ CDN åŠ é€Ÿ

- JS/CSS æ–‡ä»¶ä¸Šä¼ åˆ° CDNã€‚

- æ‰“åŒ…æ—¶ä½¿ç”¨å…¬å…±è·¯å¾„ï¼š

  ```
  output: {
    publicPath: "https://cdn.example.com/",
  }
  ```

### 2ï¸âƒ£ ç¼“å­˜ç­–ç•¥

- ç»™é™æ€èµ„æºåŠ  **hash åç§°**ï¼Œç¡®ä¿ç¼“å­˜æ›´æ–°æ­£ç¡®ã€‚

  - ä¾‹å¦‚ï¼š`main.abc123.js`

- æœåŠ¡ç«¯è®¾ç½®ç¼“å­˜å¤´ï¼š

  ```
  Cache-Control: max-age=31536000, immutable
  ```

------

## ğŸ§  äº”ã€æ¡†æ¶å±‚æŠ€å·§ï¼ˆä»¥ React / Vite ä¸ºä¾‹ï¼‰

| é—®é¢˜                 | ä¼˜åŒ–æ–¹æ¡ˆ                                                    |
| -------------------- | ----------------------------------------------------------- |
| React åº”ç”¨åˆæ¬¡åŠ è½½æ…¢ | ä½¿ç”¨ React.lazy + Suspense åŠ¨æ€åŠ è½½è·¯ç”±ç»„ä»¶                 |
| æ‰“åŒ…è¿‡å¤§             | åœ¨ Vite ä¸­é…ç½® `build.rollupOptions.output.manualChunks`    |
| UI åº“å¤ªå¤§            | ä½¿ç”¨ç»„ä»¶åº“çš„æŒ‰éœ€åŠ è½½ï¼ˆå¦‚ antd çš„ `babel-plugin-import`ï¼‰    |
| é‡å¤ä¾èµ–             | æ£€æŸ¥ `node_modules` æ˜¯å¦å®‰è£…äº†é‡å¤ç‰ˆæœ¬ï¼ˆå¯ç”¨ `npm dedupe`ï¼‰ |

------

## âœ… å®æˆ˜ä¼˜åŒ–æ•ˆæœï¼ˆçœŸå®æ¡ˆä¾‹å‚è€ƒï¼‰

| ä¼˜åŒ–æ‰‹æ®µ                | ä¼˜åŒ–å‰ | ä¼˜åŒ–å |
| ----------------------- | ------ | ------ |
| æŒ‰éœ€åŠ è½½ + Tree Shaking | 5.2 MB | 2.1 MB |
| gzip å‹ç¼©               | 2.1 MB | 450 KB |
| å›¾ç‰‡ WebP åŒ–            | 450 KB | 310 KB |
| ç¬¬ä¸‰æ–¹åº“ç²¾ç®€            | 310 KB | 180 KB |